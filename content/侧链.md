---
title: 侧链
date: 2023-11-15
tags: []
categories: []
toc: true
mathjax: true
comments: true
description: 
---
侧链是与主链通过两次密码学校验 (2WP) 链接的独立区块链，这有助于处理主链一些数据。

侧链通过 2WP 与主链连接，每个链都有自己的规则、功能和目的。

与其他第二层解决方案如通道、等离子体和缩放不同，它们利用第一层的安全性，**侧链本身负责自己的安全性**。

侧链的另一个重要点是它**需要自己的节点来验证交易和创建块**。

- 它们也有自己的一致性机制（如 POW、POS、权威证明、DPoS 等）和块参数。
- 验证交易并创建块的节点通过同样的方式在侧链中获得报酬，就像其他所有区块链一样工作。

尽管侧链彼此独立，但它们共同形成一个整体生态系统。

## 工作原理

侧链的工作原理是：

- 处理和验证主链的数据

- 或添加功能，如让无法运行智能合约的比特币链运行智能合约

侧链通过 2WP 与主链进行通信；因此，侧链也称为挂钩侧链。

1. 2WP：2WP 充当中间人，用以从主链（第一层）向侧链（第二层）转移资产或币，反之亦然。

    - 实质上，币并未转移；相反，通过在主链创建一次交易来临时锁定币。然后生成另一笔交易在侧链解锁相同数量的等值币。
    - 主链上的币只有当等量的侧链币再次被锁定时才能解锁。这是为避免同时在两条链上拥有免费币而产生双重花费问题。
    - 2WP 系统使得相关方可以在不向整个网络公开信息的情况下进行侧链交易。

2. 第三方存在：第三方/权威机构负责主链和侧链之间的锁定和释放功能。初始化一笔用于锁定币的交易。经过节点达成一致后，签名块提交至主链。这自动在主链上锁定币。

    控制双向挂钩的可信权威然后在侧链中发行等值币给交易方。交易方则可以在侧链范围内进行一系列交易。一旦交易完成，权威机构再验证交易，通过在主链上解锁对应币来释放币。

    整个侧链结构是基于双向挂钩和维护两条链之间交易完整性的可信权威。权威机构的存在可能通过给予它过于强大的权力而带来中心化。

3. SPV 证明：SPV（简单付款验证）证明是一种密码学证明，证明币已在主链上锁定用于侧链使用。与检查所有前置交易（速度较慢）不同，SPV 也证明在主链上发起的该交易是否合法并属于有效块的一部分。通过 SPV，侧链节点无需每次验证时全下主区块链。比特币和以太坊支持 [[Merkle Tree|Merkle证明]]形式的 SPV。Merkle 证明包括 Merkle 根和 Merkle 路径。

    每个对号入座的交易对使用哈希函数求和，继续下去直到一个哈希值为整个块的哈希，称为 Merkle 根或根哈希。Merkle 路径就是重新生成根哈希所需的哈希值集合。例如，交易 D 的 Merkle 路径为 C 交易的哈希、AB 交易对的哈希、EFGH 交易对的哈希以及 Merkle 根。

    侧链节点重复哈希操作计算根哈希值。如果得到的根哈希值与 SPV 中的根哈希值匹配，即表示主链已发起锁定币的该交易。

## 例子

比特币侧链的例子有 Liquid 网络和 RSK。Liquid 网络每分钟添加一个块，相比比特币每 10 分钟添加一个块。通过添加 RSK 侧链，比特币可以使用智能合约，从而拓宽其功能。因此，RSK 可以为比特币协议添加以太坊样式的层，使比特币协议能够使用智能合约开发 DApp。

xDai 链、POA 网络和 Polygon（前身为 Matic 网络）都是以太坊侧链的例子。通过使用相同的以太坊虚拟机，使侧链与以太坊主链之间实现互操作性。所以部署到以太坊基础层的合约可以直接部署到侧链。

## 优点

- 侧链通过将大量交易转入其侧链进行处理，提高了交易吞吐量，同时处理交易速度更快。它们还显著降低了交易费用。例如，以太坊侧链 Polygon 声称每个秒可实现 65000 笔交易，交易费用约 1 美元。

- 公共区块链具有透明性和可审计性。每个交易都记录并可由任何参与者验证。但对企业来说，公共区块链由于可能披露大量商业细节信息的风险而不那么有用。但通过侧链，交易的隐私性可以得到保障。与主链作为验证散列数据的存储库不同，侧链专门设计为符合企业需求的私有和被许可 Blockchain，侧链可以安全地存储企业特定数据，从而更安全可靠，免受黑客攻击。

挑战：大多数侧链比主链更加集中，由此为速度提供了一定程度的安全 trade-off。因此，可以选择将最敏感细节保留在主链上，以保持安全性，而将信息外包到侧链。
